---
# =============================================================================
# Grafana - Admin Password Secret
# =============================================================================
# ExternalSecret for Grafana admin password synced from GCP Secret Manager.
#
# To create the secret in GCP Secret Manager:
#   GRAFANA_PASSWORD=$(openssl rand -base64 32)
#   echo -n "$GRAFANA_PASSWORD" | gcloud secrets create grafana-admin-password \
#     --data-file=- \
#     --replication-policy="automatic" \
#     --labels=app=grafana,environment=production
#
# Default credentials on first deployment:
#   Username: admin
#   Password: admin (will prompt to change on first login)
# =============================================================================

apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: grafana-admin
  namespace: observability
  labels:
    app: grafana
    component: visualization
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: gcp-secret-manager
    kind: ClusterSecretStore

  target:
    name: grafana-admin
    creationPolicy: Owner

  data:
    - secretKey: password
      remoteRef:
        key: grafana-admin-password
